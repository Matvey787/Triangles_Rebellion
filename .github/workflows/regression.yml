name: Regression tests

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
    build-and-test:
        runs-on: ubuntu-latest
        steps:
          - name: Checkout repository
            uses: actions/checkout@v4
          
          - name: Giving permission to run the details folder
            run: chmod +x .github/workflows/details/*.sh

          - name: Installing project dependencies
            run: ./.github/workflows/details/install_deps.sh

          - name: Build & run gtests
            run: ./.github/workflows/details/tester_run_gtest.sh

          - name: Build projects for ctests
            run: ./.github/workflows/details/tester_create_exe_for_ctest.sh

          - name: Build & run ctests
            run: ./.github/workflows/details/tester_run_ctest.sh

          - name: Upload test summary
            if: always()
            run: ./.github/workflows/details/github_test_summary.sh

